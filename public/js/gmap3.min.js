/*!
 *  GMAP3 Plugin for jQuery
 *  Version   : 6.0.0
 *  Date      : 2014-04-25
 *  Author    : DEMONTE Jean-Baptiste
 *  Contact   : jbdemonte@gmail.com
 *  Web site  : http://gmap3.net
 *  Licence   : GPL v3 : http://www.gnu.org/licenses/gpl.html
 *  Build options : --only --get --marker --streetviewpanorama --trigger

 *  Copyright (c) 2010-2014 Jean-Baptiste DEMONTE
 *  All rights reserved.
 */
!function(t,n){function e(t){return"object"==typeof t}function r(t){return"string"==typeof t}function o(t){return"number"==typeof t}function a(t){return t===n}function i(){q=google.maps,M||(M={verbose:!1,queryLimit:{attempt:5,delay:250,random:250},classes:function(){var n={};return t.each("Map Marker InfoWindow Circle Rectangle OverlayView StreetViewPanorama KmlLayer TrafficLayer BicyclingLayer GroundOverlay StyledMapType ImageMapType".split(" "),function(t,e){n[e]=q[e]}),n}(),map:{mapTypeId:q.MapTypeId.ROADMAP,center:[46.578498,2.457275],zoom:2},overlay:{pane:"floatPane",content:"",offset:{x:0,y:0}},geoloc:{getCurrentPosition:{maximumAge:6e4,timeout:5e3}}})}function s(t,n){return a(t)?"gmap3_"+(n?A+1:++A):t}function u(n,e,r,o,a){function i(e,o){e&&t.each(e,function(t,e){var i=n,s=e;C(e)&&(i=e[0],s=e[1]),o(r,t,function(t){s.apply(i,[a||r,t,u])})})}var s=e.td||{},u={id:o,data:s.data,tag:s.tag};i(s.events,q.event.addListener),i(s.onces,q.event.addListenerOnce)}function l(t){var n,e=[];for(n in t)t.hasOwnProperty(n)&&e.push(n);return e}function c(t,n){var e,r=arguments;for(e=2;e<r.length;e++)if(n in r[e]&&r[e].hasOwnProperty(n))return void(t[n]=r[e][n])}function f(n,e){var r,o,a=["data","tag","id","events","onces"],i={};if(n.td)for(r in n.td)n.td.hasOwnProperty(r)&&"options"!==r&&"values"!==r&&(i[r]=n.td[r]);for(o=0;o<a.length;o++)c(i,a[o],e,n.td);return i.options=t.extend({},n.opts||{},e.options||{}),i}function p(){if(M.verbose){var t,n=[];if(window.console&&x(console.error)){for(t=0;t<arguments.length;t++)n.push(arguments[t]);console.error.apply(console,n)}else{for(n="",t=0;t<arguments.length;t++)n+=arguments[t].toString()+" ";alert(n)}}}function g(t){return(o(t)||r(t))&&""!==t&&!isNaN(t)}function d(t){var n,r=[];if(!a(t))if(e(t))if(o(t.length))r=t;else for(n in t)r.push(t[n]);else r.push(t);return r}function v(n){return n?x(n)?n:(n=d(n),function(r){var o;if(a(r))return!1;if(e(r)){for(o=0;o<r.length;o++)if(t.inArray(r[o],n)>=0)return!0;return!1}return t.inArray(r,n)>=0}):void 0}function h(t,n,e){var o=n?t:null;return!t||r(t)?o:t.latLng?h(t.latLng):t instanceof q.LatLng?t:g(t.lat)?new q.LatLng(t.lat,t.lng):!e&&C(t)&&g(t[0])&&g(t[1])?new q.LatLng(t[0],t[1]):o}function y(t){var n,e;return!t||t instanceof q.LatLngBounds?t||null:(C(t)?2===t.length?(n=h(t[0]),e=h(t[1])):4===t.length&&(n=h([t[0],t[1]]),e=h([t[2],t[3]])):"ne"in t&&"sw"in t?(n=h(t.ne),e=h(t.sw)):"n"in t&&"e"in t&&"s"in t&&"w"in t&&(n=h([t.n,t.e]),e=h([t.s,t.w])),n&&e?new q.LatLngBounds(e,n):null)}function m(t,n,e,o,a){var i=e?h(o.td,!1,!0):!1,s=i?{latLng:i}:o.td.address?r(o.td.address)?{address:o.td.address}:o.td.address:!1,u=s?S.get(s):!1,l=this;s?(a=a||0,u?(o.latLng=u.results[0].geometry.location,o.results=u.results,o.status=u.status,n.apply(t,[o])):(s.location&&(s.location=h(s.location)),s.bounds&&(s.bounds=y(s.bounds)),I().geocode(s,function(r,i){i===q.GeocoderStatus.OK?(S.store(s,{results:r,status:i}),o.latLng=r[0].geometry.location,o.results=r,o.status=i,n.apply(t,[o])):i===q.GeocoderStatus.OVER_QUERY_LIMIT&&a<M.queryLimit.attempt?setTimeout(function(){m.apply(l,[t,n,e,o,a+1])},M.queryLimit.delay+Math.floor(Math.random()*M.queryLimit.random)):(p("geocode failed",i,s),o.latLng=o.results=!1,o.status=i,n.apply(t,[o]))}))):(o.latLng=h(o.td,!1,!0),n.apply(t,[o]))}function L(n,e,r,o){function a(){do s++;while(s<n.length&&!("address"in n[s]));return s>=n.length?void r.apply(e,[o]):void m(i,function(e){delete e.td,t.extend(n[s],e),a.apply(i,[])},!0,{td:n[s]})}var i=this,s=-1;a()}function w(t,n,e){var r=!1;navigator&&navigator.geolocation?navigator.geolocation.getCurrentPosition(function(o){r||(r=!0,e.latLng=new q.LatLng(o.coords.latitude,o.coords.longitude),n.apply(t,[e]))},function(){r||(r=!0,e.latLng=!1,n.apply(t,[e]))},e.opts.getCurrentPosition):(e.latLng=!1,n.apply(t,[e]))}function b(t){var n,r=!1;if(e(t)&&t.hasOwnProperty("get")){for(n in t)if("get"!==n)return!1;r=!t.get.hasOwnProperty("callback")}return r}function I(){return G.geocoder||(G.geocoder=new q.Geocoder),G.geocoder}function j(){var t=[];this.get=function(n){if(t.length){var r,o,a,i,s,u=l(n);for(r=0;r<t.length;r++){for(i=t[r],s=u.length===i.keys.length,o=0;o<u.length&&s;o++)a=u[o],s=a in i.request,s&&(s=e(n[a])&&"equals"in n[a]&&x(n[a])?n[a].equals(i.request[a]):n[a]===i.request[a]);if(s)return i.results}}},this.store=function(n,e){t.push({request:n,keys:l(n),results:e})}}function B(){var t=[],n=this;n.empty=function(){return!t.length},n.add=function(n){t.push(n)},n.get=function(){return t.length?t[0]:!1},n.ack=function(){t.shift()}}function k(){function n(t){return{id:t.id,name:t.name,object:t.obj,tag:t.tag,data:t.data}}function e(t){x(t.setMap)&&t.setMap(null),x(t.remove)&&t.remove(),x(t.free)&&t.free(),t=null}var r={},o={},i=this;i.add=function(t,n,e,a){var u=t.td||{},l=s(u.id);return r[n]||(r[n]=[]),l in o&&i.clearById(l),o[l]={obj:e,sub:a,name:n,id:l,tag:u.tag,data:u.data},r[n].push(l),l},i.getById=function(t,e,r){var a=!1;return t in o&&(a=e?o[t].sub:r?n(o[t]):o[t].obj),a},i.get=function(t,e,a,i){var s,u,l=v(a);if(!r[t]||!r[t].length)return null;for(s=r[t].length;s;)if(s--,u=r[t][e?s:r[t].length-s-1],u&&o[u]){if(l&&!l(o[u].tag))continue;return i?n(o[u]):o[u].obj}return null},i.all=function(t,e,i){var s=[],u=v(e),l=function(t){var e,a;for(e=0;e<r[t].length;e++)if(a=r[t][e],a&&o[a]){if(u&&!u(o[a].tag))continue;s.push(i?n(o[a]):o[a].obj)}};if(t in r)l(t);else if(a(t))for(t in r)l(t);return s},i.rm=function(t,n,e){var a,s;if(!r[t])return!1;if(n)if(e)for(a=r[t].length-1;a>=0&&(s=r[t][a],!n(o[s].tag));a--);else for(a=0;a<r[t].length&&(s=r[t][a],!n(o[s].tag));a++);else a=e?r[t].length-1:0;return a in r[t]?i.clearById(r[t][a],a):!1},i.clearById=function(t,n){if(t in o){var i,s=o[t].name;for(i=0;a(n)&&i<r[s].length;i++)t===r[s][i]&&(n=i);return e(o[t].obj),o[t].sub&&e(o[t].sub),delete o[t],r[s].splice(n,1),!0}return!1},i.objGetById=function(t){var n,e;if(r.clusterer)for(e in r.clusterer)if((n=o[r.clusterer[e]].obj.getById(t))!==!1)return n;return!1},i.objClearById=function(t){var n;if(r.clusterer)for(n in r.clusterer)if(o[r.clusterer[n]].obj.clearById(t))return!0;return null},i.clear=function(t,n,e,o){var a,s,u,l=v(o);if(t&&t.length)t=d(t);else{t=[];for(a in r)t.push(a)}for(s=0;s<t.length;s++)if(u=t[s],n)i.rm(u,l,!0);else if(e)i.rm(u,l,!1);else for(;i.rm(u,l,!1););},i.objClear=function(n,e,a,i){var s;if(r.clusterer&&(t.inArray("marker",n)>=0||!n.length))for(s in r.clusterer)o[r.clusterer[s]].obj.clear(e,a,i)}}function O(n,e,o){function a(t){var n={};return n[t]={},n}function i(){var t;for(t in o)if(o.hasOwnProperty(t)&&!u.hasOwnProperty(t))return t}var s,u={},l=this,c={latLng:{map:!1,marker:!1,infowindow:!1,circle:!1,overlay:!1,getlatlng:!1,getmaxzoom:!1,getelevation:!1,streetviewpanorama:!1,getaddress:!0},geoloc:{getgeoloc:!0}};r(o)&&(o=a(o)),l.run=function(){for(var r,a;r=i();){if(x(n[r]))return s=r,a=t.extend(!0,{},M[r]||{},o[r].options||{}),void(r in c.latLng?o[r].values?L(o[r].values,n,n[r],{td:o[r],opts:a,session:u}):m(n,n[r],c.latLng[r],{td:o[r],opts:a,session:u}):r in c.geoloc?w(n,n[r],{td:o[r],opts:a,session:u}):n[r].apply(n,[{td:o[r],opts:a,session:u}]));u[r]=null}e.apply(n,[o,u])},l.ack=function(t){u[s]=t,l.run.apply(l,[])}}function P(e){function o(){!c&&(c=g.get())&&c.run()}function a(){c=null,g.ack(),o.call(p)}function i(t){var n,r=t.td.callback;r&&(n=Array.prototype.slice.call(arguments,1),x(r)?r.apply(e,n):C(r)&&x(r[1])&&r[1].apply(r[0],n))}function s(t,n,r){r&&u(e,t,n,r),i(t,n),c.ack(n)}function l(n,r){r=r||{};var o=r.td&&r.td.options?r.td.options:0;y?o&&(o.center&&(o.center=h(o.center)),y.setOptions(o)):(o=r.opts||t.extend(!0,{},M.map,o||{}),o.center=n||h(o.center),y=new M.classes.Map(e.get(0),o))}var c,p=this,g=new B,v=new k,y=null;p._plan=function(t){var n;for(n=0;n<t.length;n++)g.add(new O(p,a,t[n]));o()},p.map=function(t){l(t.latLng,t),u(e,t,y),s(t,y)},p.marker=function(n){var r,o="values"in n.td,a=!y;return o||(n.opts.position=n.latLng||h(n.opts.position),n.td.values=[{options:n.opts}]),n.td.values.length?(a&&l(),r=[],t.each(n.td.values,function(t,o){var i,s,l=f(n,o);l.options.position=h(l.options.position?l.options.position:o),l.options.position&&(l.options.map=y,a&&(y.setCenter(l.options.position),a=!1),s=new M.classes.Marker(l.options),r.push(s),i=v.add({td:l},"marker",s),u(e,{td:l},s,i))}),void s(n,o?r:r[0])):void s(n,!1)},p.streetviewpanorama=function(n){n.opts.opts||(n.opts.opts={}),n.latLng?n.opts.opts.position=n.latLng:n.opts.opts.position&&(n.opts.opts.position=h(n.opts.opts.position)),n.td.divId?n.opts.container=document.getElementById(n.td.divId):n.opts.container&&(n.opts.container=t(n.opts.container).get(0));var e,r=new M.classes.StreetViewPanorama(n.opts.container,n.opts.opts);r&&y.setStreetView(r),e=v.add(n,"streetviewpanorama",r),s(n,r,e)},p.get=function(e,o,a){var i,u,l=o?e:e.td;return o||(a=l.full),r(l)?(u=v.getById(l,!1,a)||v.objGetById(l),u===!1&&(i=l,l={})):i=l.name,"map"===i&&(u=y),u||(u=[],l.id?(t.each(d(l.id),function(t,n){u.push(v.getById(n,!1,a)||v.objGetById(n))}),C(l.id)||(u=u[0])):(t.each(i?d(i):[n],function(n,e){var r;l.first?(r=v.get(e,!1,l.tag,a),r&&u.push(r)):l.all?t.each(v.all(e,l.tag,a),function(t,n){u.push(n)}):(r=v.get(e,!0,l.tag,a),r&&u.push(r))}),l.all||C(i)||(u=u[0]))),u=C(u)||!l.all?u:[u],o?u:void s(e,u)},p.trigger=function(n){if(r(n.td))q.event.trigger(y,n.td);else{var e=[y,n.td.eventName];n.td.var_args&&t.each(n.td.var_args,function(t,n){e.push(n)}),q.event.trigger.apply(q.event,e)}i(n),c.ack()}}var M,q,A=0,x=t.isFunction,C=t.isArray,G={},S=new j;t.fn.gmap3=function(){var n,e=[],r=!0,o=[];for(i(),n=0;n<arguments.length;n++)arguments[n]&&e.push(arguments[n]);return e.length||e.push("map"),t.each(this,function(){var n=t(this),a=n.data("gmap3");r=!1,a||(a=new P(n),n.data("gmap3",a)),1!==e.length||"get"!==e[0]&&!b(e[0])?a._plan(e):o.push("get"===e[0]?a.get("map",!0):a.get(e[0].get,!0,e[0].get.full))}),o.length?1===o.length?o[0]:o:this}}(jQuery);